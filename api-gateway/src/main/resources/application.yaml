server:
  port: ${SERVER_PORT:8095}

#hcx headers
protocol:
  headers:
    mandatory: ${protocol_mandatory_headers:x-hcx-sender_code, x-hcx-recipient_code, x-hcx-api_call_id, x-hcx-timestamp, x-hcx-correlation_id}
    optional: ${protocol_optional_headers:x-hcx-workflow_id, x-hcx-debug_flag, x-hcx-error_details, x-hcx-debug_details, x-hcx-status}
headers:
  jose: ${jose_headers:alg, enc}

#rbac config
rbac:
  path: ${RBAC_PATH:classpath:rbac.yaml}

#hcx error headers
plainrequest:
  headers:
    mandatory: ${error_mandatory_headers:x-hcx-status, x-hcx-sender_code, x-hcx-recipient_code, x-hcx-error_details, x-hcx-correlation_id, x-hcx-api_call_id, x-hcx-timestamp}
    optional: ${error_optional_headers:x-hcx-workflow_id}

redirect:
  apis: ${redirect_apis:/v0.7/coverageeligibility/on_check, /v0.7/preauth/on_submit, /v0.7/claim/on_submit}
  roles: ${redirect_roles:payor, agency.tpa}
  headers:
    mandatory: ${redirect_mandatory_headers:x-hcx-sender_code, x-hcx-recipient_code, x-hcx-api_call_id, x-hcx-timestamp, x-hcx-correlation_id, x-hcx-status, x-hcx-redirect_to}
    optional: ${redirect_optional_headers:x-hcx-workflow_id}

notification:
  headers:
    mandatory: ${notification_mandatory_headers:x-hcx-notification_id,x-hcx-sender_code, x-hcx-recipient_code, x-hcx-api_call_id, x-hcx-timestamp, x-hcx-correlation_id}
    optional: ${notification_optional_headers:x-hcx-workflow_id,x-hcx-status,x-hcx-notification_data}

timestamp:
  range: ${timestamp_range:10000}

allowedEntitiesForForward: ${allowed_entities_for_forward:coverageeligibility, preauth, claim}
allowedRolesForForward: ${allowed_roles_for_forward:payor, agency.tpa}

jwt:
  enabled: ${JWT_ENABLED:true}
  issuer: ${JWT_ISSUER:}
  audience: ${JWT_AUDIENCE:}
  jwkUrl: ${JWT_JWK_URL:http://localhost:8080/auth/realms/sunbird-rc/protocol/openid-connect/certs}
  claimsNamespacePath: ${JWT_NS_PATH:$.realm_access.roles}

redis:
  host: ${REDIS_HOST:localhost}
  port: ${REDIS_PORT:6379}
  expires: ${REDIS_EXPIRES:3600}

registry:
  basePath: ${REGISTRY_BASE_PATH:http://a0b2bab079318431d8ca99f1efb1c25c-874274596.ap-south-1.elb.amazonaws.com:8081}
  hcxCode: ${REGISTRY_HCX_CODE:1-d2d56996-1b77-4abb-b9e9-0e6e7343c72e}
  hcxRoles: ${REGISTRY_HCX_ROLE:HIE/HIO.HCX}

hcx-api:
  basePath: ${HCX_API_BASEPATH:http://localhost:8080}

#elasticsearch config
es:
  host: ${es_host:localhost}
  port: ${es_port:9200}

#audit config
audit:
  index: ${audit_index:hcx_audit}
  alias: ${audit_alias:hcx_audit}

spring:
  main:
    web-application-type: reactive
    allow-bean-definition-overriding: true
  cloud:
    gateway:
      routes:
        - id: hcx-api-route
          uri: ${HCX_API_BASEPATH:http://localhost:8080}
          filters:
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 10
                redis-rate-limiter.burstCapacity: 20
            - CachingRequestBodyFilter
            - HCXValidationFilter
          predicates:
            - Path=/v0.7/coverageeligibility/**, /v0.7/preauth/**, /v0.7/claim/**, /v0.7/paymentnotice/**, /v0.7/hcx/**, /v0.7/predetermination/**, /v0.7/communication/**, /v0.7/notification/subscribe, /v0.7/notification/unsubscribe, /v0.7/notification/notify

        - id: hcx-api-route-audit
          uri: ${HCX_API_BASEPATH:http://localhost:8080}
          filters:
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 10
                redis-rate-limiter.burstCapacity: 20
            - CachingRequestBodyFilter
            - AuditValidationFilter
          predicates:
            - Path=/v0.7/audit/search

        - id: hcx-registry-api-route
          uri: ${HCX_API_BASEPATH:http://localhost:8080}
          filters:
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 10
                redis-rate-limiter.burstCapacity: 20
          predicates:
            - Path=/v0.7/participant/**, /health, /service/health, /v0.7/notification/subscription/list, /v0.7/notification/list
